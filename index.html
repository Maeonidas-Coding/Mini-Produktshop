<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Produkt-Shop (App-Feeling)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Security Headers (client-side meta, besser serverseitig setzen) -->
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
  <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; connect-src 'self'; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; script-src 'self' https://cdn.tailwindcss.com https://cdn.jsdelivr.net; object-src 'none'; base-uri 'self'; frame-ancestors 'self';">

  <!-- Tailwind CSS (Cascading Style Sheets) via CDN: keine Installation nötig -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- SheetJS (xlsx) zum Lesen von Excel/CSV im Browser -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

  <style>
    /* Minimal-Fallbacks, falls CDN blockiert */
    .tw-hidden{display:none}
    .toast {
      position: fixed; right: 1rem; bottom: 1rem;
      background:#111;color:#fff;padding:.75rem 1rem;border-radius:.5rem;
      box-shadow:0 6px 20px rgba(0,0,0,.25); opacity:0; transform:translateY(8px);
      transition:opacity .25s ease, transform .25s ease; z-index: 50;
    }
    .toast.show { opacity:1; transform:translateY(0) }
  </style>
</head>
<body class="bg-gray-100 text-gray-900 min-h-screen">
  <div class="max-w-6xl mx-auto p-4 md:p-6">
    <!-- Topbar -->
    <div class="flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
      <h1 class="text-2xl font-bold">Produkt-Shop von Maeonidas</h1>

      <div class="flex flex-wrap gap-2">
        <button id="btn-autoload"
          class="px-3 py-2 rounded bg-slate-800 text-white hover:bg-slate-700"
          title="Versucht automatisch data/app-data.xlsx oder CSVs zu laden">
          Daten aus <span class="font-semibold">/data</span> laden
        </button>

        <label class="px-3 py-2 rounded bg-slate-600 text-white hover:bg-slate-500 cursor-pointer">
          Dateien laden (Excel/CSV)
          <input id="file-input" type="file" accept=".xlsx,.xls,.csv" multiple class="hidden" />
        </label>

        <button id="btn-demo"
          class="px-3 py-2 rounded bg-emerald-600 text-white hover:bg-emerald-500"
          title="Kleine Beispiel-Daten laden">
          Demo-Daten laden
        </button>
      </div>
    </div>
 <!-- Vielen Dank für's reinschauen in meinen Code, Maeonidas lässt grüßen -->
    <!-- Tabs -->
    <div class="mt-4 flex items-center gap-2 border-b border-gray-200">
      <button data-tab="filter"
              class="tab-btn px-3 py-2 rounded-t bg-white border border-b-0 border-gray-200 text-sm font-medium">
        Filter
      </button>
      <button data-tab="produkte"
              class="tab-btn px-3 py-2 rounded-t bg-gray-50 border border-b-0 border-gray-200 text-sm font-medium">
        Produkte
      </button>
      <button data-tab="services"
              class="tab-btn px-3 py-2 rounded-t bg-gray-50 border border-b-0 border-gray-200 text-sm font-medium">
        Services
      </button>
      <button data-tab="warenkorb"
              class="tab-btn relative px-3 py-2 rounded-t bg-gray-50 border border-b-0 border-gray-200 text-sm font-medium">
        Warenkorb
        <span id="badge-cart"
              class="absolute -right-2 -top-2 bg-rose-600 text-white text-xs rounded-full px-2 py-0.5">0</span>
      </button>
    </div>

    <!-- Panels -->
    <div id="panel-filter" class="tab-panel bg-white p-4 border border-gray-200 rounded-b">
      <div id="filter-container" class="grid md:grid-cols-2 gap-4"></div>
      <div class="mt-4 flex gap-2">
        <button id="btn-filter-reset" class="px-3 py-2 rounded bg-slate-200 hover:bg-slate-300">Zurücksetzen</button>
        <button id="btn-to-products" class="px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700">Zu Produkte</button>
      </div>
    </div>

    <div id="panel-produkte" class="tab-panel bg-white p-4 border border-gray-200 rounded-b tw-hidden">
      <div class="mb-3 flex items-center gap-2">
        <input id="search-products" type="text" placeholder="Suche Produkte…"
               class="w-full md:w-72 border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring"
        />
        <span class="text-sm text-gray-500" id="count-products"></span>
      </div>
      <div id="products-list" class="grid gap-3"></div>
    </div>

    <div id="panel-services" class="tab-panel bg-white p-4 border border-gray-200 rounded-b tw-hidden">
      <div class="mb-2 text-sm text-gray-600" id="services-hint">Alle Services</div>
      <div class="mb-2 flex items-center gap-2">
  <input id="search-services" type="text" placeholder="Suche Services…"
         class="flex-1 border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring" />
  <button id="btn-show-all-services"
          class="px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700">Alle Services</button>
</div>
      <div id="services-list" class="grid gap-3"></div>
    </div>

    <div id="panel-warenkorb" class="tab-panel bg-white p-4 border border-gray-200 rounded-b tw-hidden">
      <div id="cart-list" class="grid gap-3"></div>
      <div class="mt-4 flex items-center justify-between">
        <div class="text-lg font-semibold">Gesamtsumme: <span id="cart-total">0,00 €</span></div>
        <div class="flex gap-2">
          <button id="btn-cart-clear" class="px-3 py-2 rounded bg-rose-600 text-white hover:bg-rose-700">Alle Produkte entfernen</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast -->
  <div id="toast" class="toast">Hinzugefügt</div>

  <!-- Demo-Daten (Fallback) -->
  <script id="demo-json" type="application/json">
  {
    "filters": [
      {"Field":"Kategorie","Value":"Abo"},
      {"Field":"Kategorie","Value":"Kauf"},
      {"Field":"Region","Value":"DE"},
      {"Field":"Region","Value":"AT"}
    ],
    "products": [
      {"id":"P1","name":"Produkt A","Kategorie":"Abo","Region":"DE","price":19.90,"service_ids":"S1;S2"},
      {"id":"P2","name":"Produkt B","Kategorie":"Kauf","Region":"DE","price":49.00,"service_ids":"S3"},
      {"id":"P3","name":"Produkt C","Kategorie":"Abo","Region":"AT","price":29.50,"service_ids":"S2;S4"}
    ],
    "services": [
      {"id":"S1","name":"Service 1","description":"Beschreibung 1"},
      {"id":"S2","name":"Service 2","description":"Beschreibung 2"},
      {"id":"S3","name":"Service 3","description":"Beschreibung 3"},
      {"id":"S4","name":"Service 4","description":"Beschreibung 4"}
    ]
  }
  </script>

  <!-- App-Logik -->
  <script src="./script.js"></script>
</body>
</html>
